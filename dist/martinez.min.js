(function(z){"object"===typeof exports&&"undefined"!==typeof module?module.exports=z():"function"===typeof define&&define.U?define([],z):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).martinez=z()})(function(){return function e(d,g,f){function a(b,q){if(!g[b]){if(!d[b]){var t="function"==typeof require&&require;if(!q&&t)return t(b,!0);if(c)return c(b,!0);t=Error("Cannot find module '"+b+"'");throw t.code="MODULE_NOT_FOUND",t;}t=g[b]={exports:{}};
d[b][0].call(t.exports,function(c){var q=d[b][1][c];return a(q?q:c)},t,t.exports,e,d,g,f)}return g[b].exports}for(var c="function"==typeof require&&require,b=0;b<f.length;b++)a(f[b]);return a}({1:[function(e,d){d.exports=e("./src/index")},{"./src/index":11}],2:[function(e,d){d.exports={P:e("./lib/rbtree"),T:e("./lib/bintree")}},{"./lib/bintree":3,"./lib/rbtree":4}],3:[function(e,d){function g(a){this.data=a;this.right=this.left=null}function f(a){this.c=null;this.m=a;this.size=0}var a=e("./treebase");
g.prototype.g=function(a){return a?this.right:this.left};g.prototype.j=function(a,b){a?this.right=b:this.left=b};f.prototype=new a;f.prototype.M=function(a){if(null===this.c)return this.c=new g(a),this.size++,!0;for(var b=0,h=null,q=this.c;;){if(null===q)return q=new g(a),h.j(b,q),ret=!0,this.size++,!0;if(0===this.m(q.data,a))return!1;b=0>this.m(q.data,a);h=q;q=q.g(b)}};f.prototype.remove=function(a){if(null===this.c)return!1;var b=new g(void 0),h=b;h.right=this.c;for(var q=null,t=null,k=1;null!==
h.g(k);){var q=h,h=h.g(k),f=this.m(a,h.data),k=0<f;0===f&&(t=h)}return null!==t?(t.data=h.data,q.j(q.right===h,h.g(null===h.left)),this.c=b.right,this.size--,!0):!1};d.exports=f},{"./treebase":5}],4:[function(e,d){function g(a){this.data=a;this.right=this.left=null;this.red=!0}function f(a){this.c=null;this.m=a;this.size=0}function a(a){return null!==a&&a.red}function c(a,c){var b=a.g(!c);a.j(!c,b.g(c));b.j(c,a);a.red=!0;b.red=!1;return b}function b(a,b){a.j(!b,c(a.g(!b),!b));return c(a,b)}var h=
e("./treebase");g.prototype.g=function(a){return a?this.right:this.left};g.prototype.j=function(a,b){a?this.right=b:this.left=b};f.prototype=new h;f.prototype.M=function(h){var f=!1;if(null===this.c)this.c=new g(h),f=!0,this.size++;else{var k=new g(void 0),d=0,e=0,u=null,m=k,r=null,l=this.c;for(m.right=this.c;;){null===l?(l=new g(h),r.j(d,l),f=!0,this.size++):a(l.left)&&a(l.right)&&(l.red=!0,l.left.red=!1,l.right.red=!1);if(a(l)&&a(r)){var v=m.right===u;l===r.g(e)?m.j(v,c(u,!e)):m.j(v,b(u,!e))}v=
this.m(l.data,h);if(0===v)break;e=d;d=0>v;null!==u&&(m=u);u=r;r=l;l=l.g(d)}this.c=k.right}this.c.red=!1;return f};f.prototype.remove=function(h){if(null===this.c)return!1;var f=new g(void 0),k=f;k.right=this.c;for(var d=null,e,u=null,m=1;null!==k.g(m);){var r=m;e=d;var d=k,k=k.g(m),l=this.m(h,k.data),m=0<l;0===l&&(u=k);if(!a(k)&&!a(k.g(m)))if(a(k.g(!m)))e=c(k,m),d.j(r,e),d=e;else if(!a(k.g(!m))&&(l=d.g(!r),null!==l))if(a(l.g(!r))||a(l.g(r))){var v=e.right===d;a(l.g(r))?e.j(v,b(d,r)):a(l.g(!r))&&e.j(v,
c(d,r));r=e.g(v);r.red=!0;k.red=!0;r.left.red=!1;r.right.red=!1}else d.red=!1,l.red=!0,k.red=!0}null!==u&&(u.data=k.data,d.j(d.right===k,k.g(null===k.left)),this.size--);this.c=f.right;null!==this.c&&(this.c.red=!1);return null!==u};d.exports=f},{"./treebase":5}],5:[function(e,d){function g(){}function f(a){this.L=a;this.h=[];this.f=null}g.prototype.clear=function(){this.c=null;this.size=0};g.prototype.find=function(a){for(var c=this.c;null!==c;){var b=this.m(a,c.data);if(0===b)return c.data;c=c.g(0<
b)}return null};g.prototype.u=function(a){for(var c=this.c,b=this.iterator();null!==c;){var h=this.m(a,c.data);if(0===h)return b.f=c,b;b.h.push(c);c=c.g(0<h)}return null};g.prototype.lowerBound=function(a){for(var c=this.c,b=this.iterator(),h=this.m;null!==c;){var f=h(a,c.data);if(0===f)return b.f=c,b;b.h.push(c);c=c.g(0<f)}for(f=b.h.length-1;0<=f;--f)if(c=b.h[f],0>h(a,c.data))return b.f=c,b.h.length=f,b;b.h.length=0;return b};g.prototype.upperBound=function(a){for(var c=this.lowerBound(a),b=this.m;null!==
c.data()&&0===b(c.data(),a);)c.next();return c};g.prototype.min=function(){var a=this.c;if(null===a)return null;for(;null!==a.left;)a=a.left;return a.data};g.prototype.max=function(){var a=this.c;if(null===a)return null;for(;null!==a.right;)a=a.right;return a.data};g.prototype.iterator=function(){return new f(this)};f.prototype.data=function(){return null!==this.f?this.f.data:null};f.prototype.next=function(){if(null===this.f){var a=this.L.c;null!==a&&this.K(a)}else if(null===this.f.right){do if(a=
this.f,this.h.length)this.f=this.h.pop();else{this.f=null;break}while(this.f.right===a)}else this.h.push(this.f),this.K(this.f.right);return null!==this.f?this.f.data:null};f.prototype.w=function(){if(null===this.f){var a=this.L.c;null!==a&&this.J(a)}else if(null===this.f.left){do if(a=this.f,this.h.length)this.f=this.h.pop();else{this.f=null;break}while(this.f.left===a)}else this.h.push(this.f),this.J(this.f.left)};f.prototype.K=function(a){for(;null!==a.left;)this.h.push(a),a=a.left;this.f=a};f.prototype.J=
function(a){for(;null!==a.right;)this.h.push(a),a=a.right;this.f=a};d.exports=g},{}],6:[function(e,d){function g(a,c){if(!(this instanceof g))return new g(a,c);this.data=a||[];this.length=this.data.length;this.compare=c||f;if(a)for(var b=Math.floor(this.length/2);0<=b;b--)this.I(b)}function f(a,c){return a<c?-1:a>c?1:0}d.exports=g;g.prototype={push:function(a){this.data.push(a);this.length++;this.R(this.length-1)},pop:function(){var a=this.data[0];this.data[0]=this.data[this.length-1];this.length--;
this.data.pop();this.I(0);return a},R:function(a){for(var c=this.data,b=this.compare;0<a;){var h=Math.floor((a-1)/2);if(0>b(c[a],c[h])){var f=c,d=f[h];f[h]=f[a];f[a]=d;a=h}else break}},I:function(a){for(var c=this.data,b=this.compare,f=this.length;;){var d=2*a+1,g=d+1,k=a;d<f&&0>b(c[d],c[k])&&(k=d);g<f&&0>b(c[g],c[k])&&(k=g);if(k===a)break;d=c;g=d[k];d[k]=d[a];d[a]=g;a=k}}}},{}],7:[function(e,d){var g=e("./signed_area");e("./equals");d.exports=function(f,a){var c=f.a,b=a.a;return c[0]>b[0]?1:c[0]<
b[0]?-1:c[1]!==b[1]?c[1]>b[1]?1:-1:f.left!==a.left?f.left?1:-1:0!==g(c,f.b.a,a.b.a)?f.B(a.b.a)?-1:1:!f.i&&a.i?1:-1}},{"./equals":10,"./signed_area":13}],8:[function(e,d){var g=e("./signed_area"),f=e("./compare_events"),a=e("./equals");d.exports=function(c,b){if(c===b)return 0;if(0!==g(c.a,c.b.a,b.a)||0!==g(c.a,c.b.a,b.b.a))return a(c.a,b.a)?c.B(b.b.a)?-1:1:c.a[0]===b.a[0]?c.a[1]<b.a[1]?-1:1:1===f(c,b)?b.S(c.a)?-1:1:c.B(b.a)?-1:1;if(c.i===b.i){if(a(c.a,b.a))return a(c.b.a,b.b.a)?0:c.l>b.l?1:-1}else return c.i?
-1:1;return 1===f(c,b)?1:-1}},{"./compare_events":7,"./equals":10,"./signed_area":13}],9:[function(e,d){d.exports={G:0,O:1,H:2,F:3}},{}],10:[function(e,d){d.exports=function(d,f){return d[0]===f[0]&&d[1]===f[1]}},{}],11:[function(e,d){function g(a,b,c,f,d){var h,k;if("number"===typeof a[0][0])for(h=0,k=a.length-1;h<k;h++){var e=a[h],p=a[h+1],q=b,n=c+1,t=f,m=d,u=new r(e,!1,void 0,q),p=new r(p,!1,u,q);u.b=p;u.l=p.l=n;0<l(u,p)?p.left=!0:u.left=!0;m[0]=A(m[0],e[0]);m[1]=A(m[1],e[1]);m[2]=C(m[2],e[0]);
m[3]=C(m[3],e[1]);t.push(u);t.push(p)}else for(h=0,k=a.length;h<k;h++)B++,g(a[h],b,B,f,d)}function f(a,b,c,f){var d=new u(null,l);B=0;g(a,!0,0,d,c);g(b,!1,0,d,f);return d}function a(a,b,d,f){null===b?(a.s=!1,a.o=!0):a.i===b.i?(a.s=!b.s,a.o=b.o):(a.s=!b.o,a.o=b.N()?!b.s:b.s);b&&(a.A=!c(b,f)||b.N()?b.A:b);a.D=c(a,f)}function c(a,b){switch(a.type){case w.G:switch(b){case 0:return!a.o;case 1:return a.o;case 2:return a.i&&a.o||!a.i&&!a.o;case 3:return!0}case w.H:return 0===b||1===b;case w.F:return 2===
b}return!1}function b(a,b,c){var f=D(a.a,a.b.a,b.a,b.b.a),d=f?f.length:0;if(0===d||1===d&&(x(a.a,b.a)||x(a.b.a,b.b.a)))return 0;if(2===d&&a.i===b.i)return a.l===b.l&&console.warn("Edges of the same polygon overlap",a.a,a.b.a,b.a,b.b.a),0;if(1===d)return x(a.a,f[0])||x(a.b.a,f[0])||h(a,f[0],c),x(b.a,f[0])||x(b.b.a,f[0])||h(b,f[0],c),1;var f=[],g=d=!1;x(a.a,b.a)?d=!0:1===l(a,b)?f.push(b,a):f.push(a,b);x(a.b.a,b.b.a)?g=!0:1===l(a.b,b.b)?f.push(b.b,a.b):f.push(a.b,b.b);if(d&&g||d)return a.type=w.O,b.type=
a.s===b.s?w.H:w.F,d&&!g&&h(f[0].b,f[1].a,c),2;if(g)return h(f[0],f[1].a,c),3;if(f[0]!==f[3].b)return h(f[0],f[1].a,c),h(f[1],f[2].a,c),3;h(f[0],f[1].a,c);h(f[3].b,f[2].a,c);return 3}function h(a,b,c){var f=new r(b,!1,a,a.i);b=new r(b,!0,a.b,a.i);x(a.a,a.b.a)&&console.warn("what is that?",a);f.l=b.l=a.l;0<l(b,a.b)&&(a.b.left=!0,b.left=!1);a.b.b=b;a.b=f;c.push(b);c.push(f);return c}function q(c,f,d,h,g,k){var e,l;d=new m(v);f=[];for(g=A(h[2],g[2]);c.length;){var p=c.pop();f.push(p);if(0===k&&p.a[0]>
g||2===k&&p.a[0]>h[2])break;if(p.left){d.M(p);l=d.u(p);e=d.u(p);p.iterator=d.u(p);if(!e||!l){var q=d;e=q.iterator();l=q.iterator();for(var q=q.iterator(),n;null!==(n=q.next())&&(e.next(),l.next(),n!==event););l=[e,l];e=l[0];l=l[1]}e.data()!==d.min()?e.w():(e=d.iterator(),e.w(),e.next());l.next();a(p,e.data(),0,k);l.data()&&2===b(p,l.data(),c)&&(a(p,e.data(),0,k),a(p,l.data(),0,k));e.data()&&2===b(e.data(),p,c)&&(l=d.u(e.data()),l.data()!==d.min()?l.w():(l=d.u(d.max()),l.next()),a(e.data(),l.data(),
0,k),a(p,e.data(),0,k))}else p=p.b,l=d.u(p),(e=d.u(p))&&l&&(e.data()!==d.min()?e.w():(e=d.iterator(),e.w(),e.next()),l.next(),d.remove(p),l.data()&&e.data()&&b(e.data(),l.data(),c))}return f}function t(a,b){"[object Array]"===Object.prototype.toString.call(a[0][0])||(a=[a]);a[b]=[]}function k(a,b,c){var d,e=null;if(0===a.length*b.length)if(0===c)e=y;else if(2===c)e=a;else if(1===c||3===c)e=0===a.length?b:a;if(d=e)return d===y?null:d;var e=[Infinity,Infinity,-Infinity,-Infinity],h=[Infinity,Infinity,
-Infinity,-Infinity],g=f(a,b,e,h);d=null;if(e[0]>h[2]||h[0]>e[2]||e[1]>h[3]||h[1]>e[3])if(0===c)d=y;else if(2===c)d=a;else if(1===c||3===c)d=a.concat(b);if(d)return d===y?null:d;e=q(g,0,0,e,h,c);a=[];b=0;for(c=e.length;b<c;b++)event=e[b],(event.left&&event.D||!event.left&&event.b.D)&&a.push(event);for(e=!1;!e;)for(e=!0,b=0,c=a.length;b<c;b++)b+1<c&&1===l(a[b],a[b+1])&&(e=a,h=b+1,g=e[b],e[b]=e[h],e[h]=g,e=!1);b=0;for(c=a.length;b<c;b++)a[b].v=b;b=0;for(c=a.length;b<c;b++)a[b].left||(e=a[b].v,a[b].v=
a[b].b.v,a[b].b.v=e);e=Array(a.length);h=[];g=[];d=[];var k={};b=0;for(c=a.length;b<c;b++)if(!e[b]){var p=[];h.push(p);var m=h.length-1;g.push(0);d.push(-1);if(a[b].A){var n=a[b].A.l;a[b].A.C?k[n]&&(t(h[d[n]],m),d[m]=d[n],g[m]=g[n],k[m]=!0):(t(h[n],m),d[m]=n,g[m]=g[n]+1,k[m]=!0)}n=b;for(p.push(a[b].a);n>=b;){e[n]=!0;a[n].left?(a[n].C=!1,a[n].l=m):(a[n].b.C=!0,a[n].b.l=m);n=a[n].v;e[n]=!0;p.push(a[n].a);a:{for(var r=a,u=e,v=n+1,w=r.length;v<w&&x(r[v].a,r[n].a);)if(u[v])v+=1;else{n=v;break a}for(v=
n-1;u[v];)--v;n=v}}n=-1===n?b:n;e[n]=e[a[n].v]=!0;a[n].b.C=!0;a[n].b.l=m;g[m]&1&&p.reverse()}return h}var y=[],w=e("./edge_type"),u=e("tinyqueue"),m=e("bintrees").P,r=e("./sweep_event"),l=e("./compare_events"),v=e("./compare_segments"),D=e("./segment_intersection"),x=e("./equals"),C=Math.max,A=Math.min,B=0;d.exports=k;d.exports.union=function(a,b){return k(a,b,1)};d.exports.diff=function(a,b){return k(a,b,2)};d.exports.$=function(a,b){return k(a,b,3)};d.exports.intersection=function(a,b){return k(a,
b,0)};d.exports.operations={INTERSECTION:0,DIFFERENCE:2,UNION:1,XOR:3};d.exports.X=f;d.exports.V=a;d.exports.Z=q;d.exports.W=h;d.exports.Y=b},{"./compare_events":7,"./compare_segments":8,"./edge_type":9,"./equals":10,"./segment_intersection":12,"./sweep_event":14,bintrees:2,tinyqueue:6}],12:[function(e,d){function g(a,c){return a[0]*c[1]-a[1]*c[0]}function f(a,c){return a[0]*c[0]+a[1]*c[1]}d.exports=function(a,c,b,d,e){function t(a,b,c){return[a[0]+b*c[0],a[1]+b*c[1]]}c=[c[0]-a[0],c[1]-a[1]];d=[d[0]-
b[0],d[1]-b[1]];b=[b[0]-a[0],b[1]-a[1]];var k=g(c,d),y=f(c,c);if(k*k>1E-9*y*f(d,d)){d=g(b,d)/k;if(0>d||1<d)return null;b=g(b,c)/k;return 0>b||1<b?null:e?null:[t(a,d,c)]}var w=f(b,b),k=g(b,c);if(k*k>1E-9*y*w)return null;b=f(c,b)/y;k=b+f(c,d)/y;d=Math.min(b,k);b=Math.max(b,k);return 1>=d&&0<=b?1===d?e?null:[t(a,0<d?d:0,c)]:0===b?e?null:[t(a,1>b?b:1,c)]:e&&0===d&&1===b?null:[t(a,0<d?d:0,c),t(a,1>b?b:1,c)]:null}},{}],13:[function(e,d){d.exports=function(d,e,a){return(d[0]-a[0])*(e[1]-a[1])-(e[0]-a[0])*
(d[1]-a[1])}},{}],14:[function(e,d){function g(c,b,d,e,f){this.left=b;this.a=c;this.b=d;this.i=e;this.type=f||a.G;this.o=this.s=!1;this.A=null;this.C=this.D=!1}var f=e("./signed_area"),a=e("./edge_type");g.prototype={B:function(a){return this.left?0<f(this.a,this.b.a,a):0<f(this.b.a,this.a,a)},S:function(a){return!this.B(a)},N:function(){return this.a[0]===this.b.a[0]}};d.exports=g},{"./edge_type":9,"./signed_area":13}]},{},[1])(1)});
