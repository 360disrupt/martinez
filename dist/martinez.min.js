(function(z){"object"===typeof exports&&"undefined"!==typeof module?module.exports=z():"function"===typeof define&&define.V?define([],z):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).martinez=z()})(function(){return function h(g,e,c){function b(d,k){if(!e[d]){if(!g[d]){var t="function"==typeof require&&require;if(!k&&t)return t(d,!0);if(a)return a(d,!0);t=Error("Cannot find module '"+d+"'");throw t.code="MODULE_NOT_FOUND",t;}t=e[d]={exports:{}};
g[d][0].call(t.exports,function(a){var k=g[d][1][a];return b(k?k:a)},t,t.exports,h,g,e,c)}return e[d].exports}for(var a="function"==typeof require&&require,d=0;d<c.length;d++)b(c[d]);return b}({1:[function(h,g){g.exports=h("./src/index")},{"./src/index":11}],2:[function(h,g){g.exports={P:h("./lib/rbtree"),T:h("./lib/bintree")}},{"./lib/bintree":3,"./lib/rbtree":4}],3:[function(h,g){function e(a){this.data=a;this.right=this.left=null}function c(a){this.c=null;this.m=a;this.size=0}var b=h("./treebase");
e.prototype.g=function(a){return a?this.right:this.left};e.prototype.l=function(a,b){a?this.right=b:this.left=b};c.prototype=new b;c.prototype.M=function(a){if(null===this.c)return this.c=new e(a),this.size++,!0;for(var b=0,f=null,k=this.c;;){if(null===k)return k=new e(a),f.l(b,k),ret=!0,this.size++,!0;if(0===this.m(k.data,a))return!1;b=0>this.m(k.data,a);f=k;k=k.g(b)}};c.prototype.remove=function(b){if(null===this.c)return!1;var d=new e(void 0),f=d;f.right=this.c;for(var k=null,c=null,u=1;null!==
f.g(u);){var k=f,f=f.g(u),g=this.m(b,f.data),u=0<g;0===g&&(c=f)}return null!==c?(c.data=f.data,k.l(k.right===f,f.g(null===f.left)),this.c=d.right,this.size--,!0):!1};g.exports=c},{"./treebase":5}],4:[function(h,g){function e(b){this.data=b;this.right=this.left=null;this.red=!0}function c(b){this.c=null;this.m=b;this.size=0}function b(b){return null!==b&&b.red}function a(b,a){var d=b.g(!a);b.l(!a,d.g(a));d.l(a,b);b.red=!0;d.red=!1;return d}function d(b,d){b.l(!d,a(b.g(!d),!d));return a(b,d)}var f=
h("./treebase");e.prototype.g=function(b){return b?this.right:this.left};e.prototype.l=function(b,a){b?this.right=a:this.left=a};c.prototype=new f;c.prototype.M=function(k){var c=!1;if(null===this.c)this.c=new e(k),c=!0,this.size++;else{var f=new e(void 0),g=0,h=0,p=null,r=f,q=null,l=this.c;for(r.right=this.c;;){null===l?(l=new e(k),q.l(g,l),c=!0,this.size++):b(l.left)&&b(l.right)&&(l.red=!0,l.left.red=!1,l.right.red=!1);if(b(l)&&b(q)){var v=r.right===p;l===q.g(h)?r.l(v,a(p,!h)):r.l(v,d(p,!h))}v=
this.m(l.data,k);if(0===v)break;h=g;g=0>v;null!==p&&(r=p);p=q;q=l;l=l.g(g)}this.c=f.right}this.c.red=!1;return c};c.prototype.remove=function(k){if(null===this.c)return!1;var c=new e(void 0),f=c;f.right=this.c;for(var g=null,h,p=null,r=1;null!==f.g(r);){var q=r;h=g;var g=f,f=f.g(r),l=this.m(k,f.data),r=0<l;0===l&&(p=f);if(!b(f)&&!b(f.g(r)))if(b(f.g(!r)))h=a(f,r),g.l(q,h),g=h;else if(!b(f.g(!r))&&(l=g.g(!q),null!==l))if(b(l.g(!q))||b(l.g(q))){var v=h.right===g;b(l.g(q))?h.l(v,d(g,q)):b(l.g(!q))&&h.l(v,
a(g,q));q=h.g(v);q.red=!0;f.red=!0;q.left.red=!1;q.right.red=!1}else g.red=!1,l.red=!0,f.red=!0}null!==p&&(p.data=f.data,g.l(g.right===f,f.g(null===f.left)),this.size--);this.c=c.right;null!==this.c&&(this.c.red=!1);return null!==p};g.exports=c},{"./treebase":5}],5:[function(h,g){function e(){}function c(b){this.L=b;this.j=[];this.f=null}e.prototype.clear=function(){this.c=null;this.size=0};e.prototype.find=function(b){for(var a=this.c;null!==a;){var d=this.m(b,a.data);if(0===d)return a.data;a=a.g(0<
d)}return null};e.prototype.o=function(b){for(var a=this.c,d=this.iterator();null!==a;){var f=this.m(b,a.data);if(0===f)return d.f=a,d;d.j.push(a);a=a.g(0<f)}return null};e.prototype.lowerBound=function(b){for(var a=this.c,d=this.iterator(),f=this.m;null!==a;){var c=f(b,a.data);if(0===c)return d.f=a,d;d.j.push(a);a=a.g(0<c)}for(c=d.j.length-1;0<=c;--c)if(a=d.j[c],0>f(b,a.data))return d.f=a,d.j.length=c,d;d.j.length=0;return d};e.prototype.upperBound=function(b){for(var a=this.lowerBound(b),d=this.m;null!==
a.data()&&0===d(a.data(),b);)a.next();return a};e.prototype.min=function(){var b=this.c;if(null===b)return null;for(;null!==b.left;)b=b.left;return b.data};e.prototype.max=function(){var b=this.c;if(null===b)return null;for(;null!==b.right;)b=b.right;return b.data};e.prototype.iterator=function(){return new c(this)};c.prototype.data=function(){return null!==this.f?this.f.data:null};c.prototype.next=function(){if(null===this.f){var b=this.L.c;null!==b&&this.K(b)}else if(null===this.f.right){do if(b=
this.f,this.j.length)this.f=this.j.pop();else{this.f=null;break}while(this.f.right===b)}else this.j.push(this.f),this.K(this.f.right);return null!==this.f?this.f.data:null};c.prototype.D=function(){if(null===this.f){var b=this.L.c;null!==b&&this.J(b)}else if(null===this.f.left){do if(b=this.f,this.j.length)this.f=this.j.pop();else{this.f=null;break}while(this.f.left===b)}else this.j.push(this.f),this.J(this.f.left)};c.prototype.K=function(b){for(;null!==b.left;)this.j.push(b),b=b.left;this.f=b};c.prototype.J=
function(b){for(;null!==b.right;)this.j.push(b),b=b.right;this.f=b};g.exports=e},{}],6:[function(h,g){function e(b,a){if(!(this instanceof e))return new e(b,a);this.data=b||[];this.length=this.data.length;this.compare=a||c;if(b)for(var d=Math.floor(this.length/2);0<=d;d--)this.I(d)}function c(b,a){return b<a?-1:b>a?1:0}g.exports=e;e.prototype={push:function(b){this.data.push(b);this.length++;this.R(this.length-1)},pop:function(){var b=this.data[0];this.data[0]=this.data[this.length-1];this.length--;
this.data.pop();this.I(0);return b},R:function(b){for(var a=this.data,d=this.compare;0<b;){var f=Math.floor((b-1)/2);if(0>d(a[b],a[f])){var c=a,g=c[f];c[f]=c[b];c[b]=g;b=f}else break}},I:function(b){for(var a=this.data,d=this.compare,f=this.length;;){var c=2*b+1,g=c+1,e=b;c<f&&0>d(a[c],a[e])&&(e=c);g<f&&0>d(a[g],a[e])&&(e=g);if(e===b)break;c=a;g=c[e];c[e]=c[b];c[b]=g;b=e}}}},{}],7:[function(h,g){var e=h("./signed_area");g.exports=function(c,b){var a=c.a,d=b.a;return a[0]>d[0]?1:a[0]<d[0]?-1:a[1]!==
d[1]?a[1]>d[1]?1:-1:c.left!==b.left?c.left?1:-1:0!==e(a,c.b.a,b.b.a)?c.A(b.b.a)?-1:1:c.h===b.h?c.i===b.i?0:c.i>b.i?1:-1:!c.h&&b.h?1:-1}},{"./signed_area":13}],8:[function(h,g){var e=h("./signed_area"),c=h("./compare_events"),b=h("./equals");g.exports=function(a,d){if(a===d)return 0;if(0!==e(a.a,a.b.a,d.a)||0!==e(a.a,a.b.a,d.b.a))return b(a.a,d.a)?a.A(d.b.a)?-1:1:a.a[0]===d.a[0]?a.a[1]<d.a[1]?-1:1:1===c(a,d)?d.S(a.a)?-1:1:a.A(d.a)?-1:1;if(a.h===d.h){if(b(a.a,d.a))return a.i===d.i?0:a.i>d.i?1:-1;if(a.h!==
d.h)return a.h&&!d.h?1:-1}return 1===c(a,d)?1:-1}},{"./compare_events":7,"./equals":10,"./signed_area":13}],9:[function(h,g){g.exports={G:0,O:1,H:2,F:3}},{}],10:[function(h,g){g.exports=function(g,c){return g[0]===c[0]&&g[1]===c[1]}},{}],11:[function(h,g){(function(e){function c(b,a,d,f,g){var e,h;if("number"===typeof b[0][0])for(e=0,h=b.length-1;e<h;e++){var k=b[e],m=b[e+1],q=a,n=d+1,p=f,t=g,r=new l(k,!1,void 0,q),m=new l(m,!1,r,q);r.b=m;r.i=m.i=n;0<v(r,m)?m.left=!0:r.left=!0;t[0]=A(t[0],k[0]);t[1]=
A(t[1],k[1]);t[2]=C(t[2],k[0]);t[3]=C(t[3],k[1]);p.push(r);p.push(m)}else for(e=0,h=b.length;e<h;e++)B++,c(b[e],a,B,f,g)}function b(b,a,d,f){var g=new r(null,v);B=0;c(b,!0,0,g,d);c(a,!1,0,g,f);return g}function a(b,a,c,f){null===a?(b.u=!1,b.s=!0):b.h===a.h?(b.u=!a.u,b.s=a.s):(b.u=!a.s,b.s=a.N()?!a.u:a.u);a&&(b.w=!d(a,f)||a.N()?a.w:a);b.C=d(b,f)}function d(b,a){switch(b.type){case p.G:switch(a){case 0:return!b.s;case 1:return b.s;case 2:return b.h&&b.s||!b.h&&!b.s;case 3:return!0}case p.H:return 0===
a||1===a;case p.F:return 2===a}return!1}function f(b,a,d){var c=D(b.a,b.b.a,a.a,a.b.a),f=c?c.length:0;if(0===f||1===f&&(x(b.a,a.a)||x(b.b.a,a.b.a)))return 0;if(2===f&&b.h===a.h)return b.i===a.i&&console.warn("Edges of the same polygon overlap",b.a,b.b.a,a.a,a.b.a),0;if(1===f)return x(b.a,c[0])||x(b.b.a,c[0])||k(b,c[0],d),x(a.a,c[0])||x(a.b.a,c[0])||k(a,c[0],d),1;var c=[],g=f=!1;x(b.a,a.a)?f=!0:1===v(b,a)?c.push(a,b):c.push(b,a);x(b.b.a,a.b.a)?g=!0:1===v(b.b,a.b)?c.push(a.b,b.b):c.push(b.b,a.b);if(f&&
g||f)return b.type=p.O,a.type=b.u===a.u?p.H:p.F,f&&!g&&k(c[0].b,c[1].a,d),2;if(g)return k(c[0],c[1].a,d),3;if(c[0]!==c[3].b)return k(c[0],c[1].a,d),k(c[1],c[2].a,d),3;k(c[0],c[1].a,d);k(c[3].b,c[2].a,d);return 3}function k(b,a,d){var c=new l(a,!1,b,b.h);a=new l(a,!0,b.b,b.h);0<v(a,b.b)&&(b.b.left=!0,a.left=!1);b.b.b=a;b.b=c;d.push(a);d.push(c);return d}function t(b,d,c,g,e,h){var k;c=new q(E);d=[];for(var t=A(g[2],e[2]);b.length;){var m=b.pop();d.push(m);if(0===h&&m.a[0]>t||2===h&&m.a[0]>g[2])break;
m.left?(c.M(m),k=c.o(m),e=c.o(m),m.iterator=c.o(m),e.data()!==c.min()?e.D():(e=c.o(c.max()),e.next()),k.next(),a(m,e.data(),0,h),k.data()&&2===f(m,k.data(),b)&&(a(m,e.data(),0,h),a(m,k.data(),0,h)),e.data()&&2===f(e.data(),m,b)&&(k=c.o(e.data()),k.data()!==c.min()?k.D():(k=c.o(c.max()),k.next()),a(e.data(),k.data(),0,h),a(m,e.data(),0,h))):(m=m.b,k=c.o(m),(e=c.o(m))&&k&&(e.data()!==c.min()?e.D():(e=c.o(c.max()),e.next()),k.next(),c.remove(m),k.data()&&e.data()&&f(e.data(),k.data(),b)))}return d}function u(b,
a){"[object Array]"===Object.prototype.toString.call(b[0][0])||(b=[b]);b[a]=[]}function w(a,c,d){var f,e=null;if(0===a.length*c.length)if(0===d)e=y;else if(2===d)e=a;else if(1===d||3===d)e=0===a.length?c:a;if(f=e)return f===y?null:f;var e=[Infinity,Infinity,-Infinity,-Infinity],g=[Infinity,Infinity,-Infinity,-Infinity],k=b(a,c,e,g);f=null;if(e[0]>g[2]||g[0]>e[2]||e[1]>g[3]||g[1]>e[3])if(0===d)f=y;else if(2===d)f=a;else if(1===d||3===d)f=a.concat(c);if(f)return f===y?null:f;e=t(k,0,0,e,g,d);a=[];c=
0;for(d=e.length;c<d;c++)event=e[c],(event.left&&event.C||!event.left&&event.b.C)&&a.push(event);for(e=!1;!e;)for(e=!0,c=0,d=a.length;c<d;c++)c+1<d&&1===v(a[c],a[c+1])&&(e=a,g=c+1,k=e[c],e[c]=e[g],e[g]=k,e=!1);c=0;for(d=a.length;c<d;c++)a[c].v=c;c=0;for(d=a.length;c<d;c++)a[c].left||(e=a[c].v,a[c].v=a[c].b.v,a[c].b.v=e);e=Array(a.length);g=[];k=[];f=[];var h={};c=0;for(d=a.length;c<d;c++)if(!e[c]){var m=[];g.push(m);var l=g.length-1;k.push(0);f.push(-1);if(a[c].w){var n=a[c].w.i;a[c].w.B?h[n]&&(u(g[f[n]],
l),f[l]=f[n],k[l]=k[n],h[l]=!0):(u(g[n],l),f[l]=n,k[l]=k[n]+1,h[l]=!0)}n=c;for(m.push(a[c].a);n>=c;){e[n]=!0;a[n].left?(a[n].B=!1,a[n].i=l):(a[n].b.B=!0,a[n].b.i=l);n=a[n].v;e[n]=!0;m.push(a[n].a);a:{for(var q=a,r=e,p=n+1,w=q.length;p<w&&x(q[p].a,q[n].a);)if(r[p])p+=1;else{n=p;break a}for(p=n-1;r[p];)--p;n=p}}n=-1===n?c:n;e[n]=e[a[n].v]=!0;a[n].b.B=!0;a[n].b.i=l;k[l]&1&&m.reverse()}return g}var y=[],p=h("./edge_type"),r=h("tinyqueue"),q=h("bintrees").P,l=h("./sweep_event"),v=h("./compare_events"),
E=h("./compare_segments"),D=h("./segment_intersection"),x=h("./equals"),C=Math.max,A=Math.min;e.U=q;var B=0;g.exports=w;g.exports.union=function(a,b){return w(a,b,1)};g.exports.diff=function(a,b){return w(a,b,2)};g.exports.aa=function(a,b){return w(a,b,3)};g.exports.intersection=function(a,b){return w(a,b,0)};g.exports.operations={INTERSECTION:0,DIFFERENCE:2,UNION:1,XOR:3};g.exports.Y=b;g.exports.W=a;g.exports.$=t;g.exports.X=k;g.exports.Z=f}).call(this,"undefined"!==typeof global?global:"undefined"!==
typeof self?self:"undefined"!==typeof window?window:{})},{"./compare_events":7,"./compare_segments":8,"./edge_type":9,"./equals":10,"./segment_intersection":12,"./sweep_event":14,bintrees:2,tinyqueue:6}],12:[function(h,g){function e(b,a){return b[0]*a[1]-b[1]*a[0]}function c(b,a){return b[0]*a[0]+b[1]*a[1]}g.exports=function(b,a,d,f,g){function h(a,b,c){return[a[0]+b*c[0],a[1]+b*c[1]]}a=[a[0]-b[0],a[1]-b[1]];f=[f[0]-d[0],f[1]-d[1]];d=[d[0]-b[0],d[1]-b[1]];var u=e(a,f),w=c(a,a);if(u*u>1E-9*w*c(f,f)){f=
e(d,f)/u;if(0>f||1<f)return null;d=e(d,a)/u;return 0>d||1<d?null:g?null:[h(b,f,a)]}var y=c(d,d),u=e(d,a);if(u*u>1E-9*w*y)return null;d=c(a,d)/w;u=d+c(a,f)/w;f=Math.min(d,u);d=Math.max(d,u);return 1>=f&&0<=d?1===f?g?null:[h(b,0<f?f:0,a)]:0===d?g?null:[h(b,1>d?d:1,a)]:g&&0===f&&1===d?null:[h(b,0<f?f:0,a),h(b,1>d?d:1,a)]:null}},{}],13:[function(h,g){g.exports=function(e,c,b){return(e[0]-b[0])*(c[1]-b[1])-(c[0]-b[0])*(e[1]-b[1])}},{}],14:[function(h,g){function e(a,c,e,g,h){this.left=c;this.a=a;this.b=
e;this.h=g;this.type=h||b.G;this.s=this.u=!1;this.w=null;this.B=this.C=!1}var c=h("./signed_area"),b=h("./edge_type");e.prototype={A:function(a){return this.left?0<c(this.a,this.b.a,a):0<c(this.b.a,this.a,a)},S:function(a){return!this.A(a)},N:function(){return this.a[0]===this.b.a[0]}};g.exports=e},{"./edge_type":9,"./signed_area":13}]},{},[1])(1)});
